<!doctype html>
<html lang='en'>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <title>Calculator</title>

    <script>
      let formulaArray = [];
      let formulaString = '';
      let operandCounter = 0;
      let lastOperator;
      let operatorArray = [];

      function reset() {
        const zeroDisplay = 0;
        formulaArray = [];
        formulaString = '';
        document.getElementById('formula').innerHTML = "";
        document.getElementById('display').innerHTML = zeroDisplay;
      }
      function operandInput(value) {
        operatorArray.push(value);
        if (formulaString != '') {
          formulaArray.push(formulaString);
        }
          formulaString = '';
        document.getElementById('formula').innerHTML = formulaArray.join("") + value;
      }

      function buildFormula(value) {
        console.log(formulaArray,operatorArray);
        if (operatorArray.length > 2) {
          formulaArray.push(operatorArray[operatorArray.length - 1]);
        } else if (operatorArray.length === 2 && operatorArray[1] === '-'){
          formulaArray = formulaArray.concat(operatorArray);
        } else if (operatorArray.length === 2) {
          formulaArray.push(operatorArray[1]);
        } else if (operatorArray.length === 1){
          formulaArray.push(operatorArray[0]);
        }
        operatorArray = [];
        lastOperator = '';
        if (value === '=') {
          formulaArray.push(formulaString);
          for (let i = 1; i < formulaArray.length; i++) {
            if (formulaArray[i] === '-' && formulaArray[i+1] === '-') {
              formulaArray.splice(i,0,'(');
              formulaArray.splice(i+4,0,')');
            }
          }
          formulaString = eval(formulaArray.join(''))
          document.getElementById('formula').innerHTML = formulaArray.join("");
          document.getElementById('display').innerHTML = formulaString;
          document.getElementById('display').innertext = formulaString;
          formulaArray = [];
        } else if (formulaString === '0' && value === 0) {
          formulaString = '0';
        } else if (value === '.'  && formulaString.includes('.')) {
          formulaString = formulaString;
        } else {
          formulaString = formulaString + value;
          console.log(formulaArray);
          document.getElementById('formula').innerHTML = formulaArray.join('');
          document.getElementById('display').innerHTML = formulaString;
        }
      }

    </script>


  </head>

  <style>

    .btn {
      margin: 0px 0px 0px 0px;
      border-radius; 0px;
    }

    #formula,#display {
      height: 20px;
    }

    #clear {
      width: 6.4rem !important;
    }

    #zero {
      width: 8.76rem !important;
    }

    .btn {
      width: 3rem;
      height: 3rem;
    }

  </style>

  <body>

    <div class='container-fluid'>
      <h1 class='text-center'>Andy's Javascript Calculator</h1>
      <div class='row'>
        <div class='col-sm-5'></div>
        <div class='col-sm-2'>
          <div id='formula' class='bg-info text-center text-white height-1px'> </div>
          <div id='display' class='bg-info text-center text-white'>0</div>
        </div>
      </div>
      <div class='row'>
        <div class='col-sm-5'></div>
        <div class='col-sm-2 d-flex justify-content-center'>
          <button id='clear' class='btn btn-outline-danger' onclick='reset()'>AC</button>
          <button id='divide' class='btn btn-outline-secondary' onclick='operandInput("/")'>/</button>
          <button id='multiply' class='btn btn-outline-secondary' onclick='operandInput("*")'>*</button>
        </div>
      </div>
      <div class='row'>
        <div class='col-sm-5'></div>
        <div class='col-sm-2 d-flex justify-content-center'>
          <button id='seven' class='btn btn-outline-dark' onclick='buildFormula(7)'>7</button>
          <button id='eight' class='btn btn-outline-dark' onclick='buildFormula(8)'>8</button>
          <button id='nine' class='btn btn-outline-dark' onclick='buildFormula(9)'>9</button>
          <button id='subtract' class='btn btn-outline-secondary' onclick='operandInput("-")'>-</button>
        </div>
      </div>
      <div class='row'>
        <div class='col-sm-5'></div>
        <div class='col-sm-2 d-flex justify-content-center'>
          <button id='four' class='btn btn-outline-dark' onclick='buildFormula(4)'>4</button>
          <button id='five' class='btn btn-outline-dark' onclick='buildFormula(5)'>5</button>
          <button id='six' class='btn btn-outline-dark' onclick='buildFormula(6)'>6</button>
          <button id='add' class='btn btn-outline-secondary' onclick='operandInput("+")'>+</button>
        </div>
      </div>
      <div class='row'>
        <div class='col-sm-5'></div>
        <div class='col-sm-2 d-flex justify-content-center'>
          <button id='one' class='btn btn-outline-dark' onclick='buildFormula(1)'>1</button>
          <button id='two' class='btn btn-outline-dark' onclick='buildFormula(2)'>2</button>
          <button id='three' class='btn btn-outline-dark' onclick='buildFormula(3)'>3</button>
          <button id='equals' class='btn btn-outline-success' onclick='buildFormula("=")'>=</button>
        </div>
      </div>
      <div class='row'>
        <div class='col-sm-5'></div>
        <div class='col-sm-2 d-flex justify-content-center'>
          <button id='zero' class='btn btn-outline-dark' onclick='buildFormula(0)'>0</button>
          <button id='decimal' class='btn btn-outline-dark' onclick='buildFormula(".")'>.</button>
        </div>
      </div>
    </div>


    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ho+j7jyWK8fNQe+A12Hb8AhRq26LrZ/JpcUGGOn+Y7RsweNrtN/tE3MoK7ZeZDyx" crossorigin="anonymous"></script>
  </body>
</html>
